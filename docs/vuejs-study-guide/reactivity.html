<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reactivity - Vue.js Study Guide</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">Vue.js Study Guide</a>
            <ul class="nav-links">
                <li><a href="index.html">Introduction</a></li>
                <li><a href="components.html">Components</a></li>
                <li><a href="reactivity.html" class="active">Reactivity</a></li>
                <li><a href="templates.html">Templates</a></li>
                <li><a href="forms.html">Forms</a></li>
                <li><a href="inertia.html">Inertia.js</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <h1 style="margin-bottom: 2rem;">Vue Reactivity System</h1>

        <!-- What is Reactivity -->
        <div class="card">
            <h2>What is Reactivity?</h2>
            <p>Reactivity means the UI <strong>automatically updates</strong> when your data changes.</p>

            <div class="flow">
                <div class="flow-box">Data Changes</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-box">Vue Detects It</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-box">DOM Updates</div>
            </div>

            <h3>Without Reactivity (Plain JavaScript)</h3>
<pre>
<span class="keyword">let</span> count = 0;
count++;  <span class="comment">// The number changed...</span>
<span class="comment">// ...but the HTML doesn't update! You'd need:</span>
document.<span class="function">getElementById</span>(<span class="string">'count'</span>).textContent = count;
</pre>

            <h3>With Vue Reactivity</h3>
<pre>
<span class="keyword">const</span> count = <span class="function">ref</span>(0);
count.<span class="variable">value</span>++;  <span class="comment">// Vue automatically updates the UI!</span>
</pre>
        </div>

        <!-- ref() -->
        <div class="card">
            <h2>1. ref() - Reactive Variables</h2>
            <p><code class="inline-code">ref()</code> creates a reactive variable that triggers UI updates when changed.</p>

<pre>
<span class="keyword">import</span> { ref } <span class="keyword">from</span> <span class="string">'vue'</span>;

<span class="comment">// Create reactive variables</span>
<span class="keyword">const</span> count = <span class="function">ref</span>(0);          <span class="comment">// Number</span>
<span class="keyword">const</span> name = <span class="function">ref</span>(<span class="string">'John'</span>);       <span class="comment">// String</span>
<span class="keyword">const</span> isOpen = <span class="function">ref</span>(<span class="keyword">false</span>);      <span class="comment">// Boolean</span>
<span class="keyword">const</span> items = <span class="function">ref</span>([]);         <span class="comment">// Array</span>

<span class="comment">// In script: access with .value</span>
count.<span class="variable">value</span> = 5;
console.<span class="function">log</span>(count.<span class="variable">value</span>);  <span class="comment">// 5</span>

<span class="comment">// In template: NO .value needed!</span>
<span class="comment">// {{ count }} automatically unwraps to 5</span>
</pre>

            <h3>Real Example: AuthenticatedLayout.vue</h3>
<pre>
<span class="comment">// Toggle for mobile navigation menu</span>
<span class="keyword">const</span> showingNavigationDropdown = <span class="function">ref</span>(<span class="keyword">false</span>);

<span class="comment">// In template - clicking toggles the value</span>
<span class="tag">&lt;button</span> <span class="attr">@click</span>=<span class="string">"showingNavigationDropdown = !showingNavigationDropdown"</span><span class="tag">&gt;</span>
    Menu
<span class="tag">&lt;/button&gt;</span>

<span class="comment">&lt;!-- Show/hide based on the value --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">:class</span>=<span class="string">"{ block: showingNavigationDropdown, hidden: !showingNavigationDropdown }"</span><span class="tag">&gt;</span>
    ...mobile menu...
<span class="tag">&lt;/div&gt;</span>
</pre>

            <div class="callout callout-warning">
                <strong>Remember:</strong> Use <code class="inline-code">.value</code> in <code class="inline-code">&lt;script&gt;</code>, but NOT in <code class="inline-code">&lt;template&gt;</code>!
            </div>
        </div>

        <!-- computed() -->
        <div class="card">
            <h2>2. computed() - Derived Values</h2>
            <p><code class="inline-code">computed()</code> creates a value that <strong>automatically recalculates</strong> when its dependencies change.</p>

<pre>
<span class="keyword">import</span> { computed } <span class="keyword">from</span> <span class="string">'vue'</span>;

<span class="comment">// Basic computed</span>
<span class="keyword">const</span> firstName = <span class="function">ref</span>(<span class="string">'John'</span>);
<span class="keyword">const</span> lastName = <span class="function">ref</span>(<span class="string">'Doe'</span>);

<span class="keyword">const</span> fullName = <span class="function">computed</span>(() => {
    <span class="keyword">return</span> firstName.<span class="variable">value</span> + <span class="string">' '</span> + lastName.<span class="variable">value</span>;
});

<span class="comment">// fullName automatically updates when firstName or lastName changes!</span>
console.<span class="function">log</span>(fullName.<span class="variable">value</span>);  <span class="comment">// "John Doe"</span>
</pre>

            <h3>Real Examples from Your App</h3>

            <h4>Example 1: NavLink.vue - Dynamic CSS</h4>
<pre>
<span class="keyword">const</span> classes = <span class="function">computed</span>(() =>
    props.active
        ? <span class="string">'border-indigo-400 text-gray-900'</span>   <span class="comment">// Active link</span>
        : <span class="string">'border-transparent text-gray-500'</span>  <span class="comment">// Inactive link</span>
);

<span class="comment">// Whenever props.active changes, classes recalculates</span>
</pre>

            <h4>Example 2: AuthenticatedLayout.vue - Role-Based Logic</h4>
<pre>
<span class="keyword">const</span> page = <span class="function">usePage</span>();
<span class="keyword">const</span> user = <span class="function">computed</span>(() => page.props.auth.user);

<span class="comment">// Determine which dashboard to show based on role</span>
<span class="keyword">const</span> dashboardRoute = <span class="function">computed</span>(() => {
    <span class="keyword">switch</span> (user.<span class="variable">value</span>?.role) {
        <span class="keyword">case</span> <span class="string">'employee'</span>: <span class="keyword">return</span> <span class="string">'employee.dashboard'</span>;
        <span class="keyword">case</span> <span class="string">'dept_manager'</span>: <span class="keyword">return</span> <span class="string">'manager.dashboard'</span>;
        <span class="keyword">case</span> <span class="string">'hr_admin'</span>:
        <span class="keyword">case</span> <span class="string">'ceo'</span>: <span class="keyword">return</span> <span class="string">'hr.dashboard'</span>;
    }
});

<span class="comment">// Check if user is HR</span>
<span class="keyword">const</span> isHR = <span class="function">computed</span>(() => 
    [<span class="string">'hr_admin'</span>, <span class="string">'ceo'</span>].<span class="function">includes</span>(user.<span class="variable">value</span>?.role)
);
</pre>

            <h4>Example 3: Employee Dashboard - Filtering</h4>
<pre>
<span class="comment">// Get today's date in YYYY-MM-DD format</span>
<span class="keyword">const</span> today = <span class="function">computed</span>(() => 
    <span class="keyword">new</span> <span class="function">Date</span>().<span class="function">toISOString</span>().<span class="function">split</span>(<span class="string">'T'</span>)[0]
);

<span class="comment">// Filter balances that have available days</span>
<span class="keyword">const</span> availableBalances = <span class="function">computed</span>(() => {
    <span class="keyword">return</span> props.balances.<span class="function">filter</span>(b => <span class="function">getAvailableBalance</span>(b) > 0);
});

<span class="comment">// Check if user has any balance at all</span>
<span class="keyword">const</span> hasBalance = <span class="function">computed</span>(() => {
    <span class="keyword">return</span> props.balances.<span class="function">some</span>(b => b.balance > 0);
});
</pre>
        </div>

        <!-- watch() -->
        <div class="card">
            <h2>3. watch() - Reacting to Changes</h2>
            <p><code class="inline-code">watch()</code> runs code whenever a value changes. Use it for <strong>side effects</strong>.</p>

<pre>
<span class="keyword">import</span> { watch } <span class="keyword">from</span> <span class="string">'vue'</span>;

<span class="comment">// Watch a ref</span>
<span class="keyword">const</span> searchQuery = <span class="function">ref</span>(<span class="string">''</span>);

<span class="function">watch</span>(searchQuery, (newValue, oldValue) => {
    console.<span class="function">log</span>(<span class="string">`Search changed from "${oldValue}" to "${newValue}"`</span>);
    <span class="comment">// Trigger API call, etc.</span>
});
</pre>

            <h3>Real Example: Manager Dashboard</h3>
<pre>
<span class="comment">// Manager/Dashboard.vue</span>
<span class="keyword">const</span> selectedType = <span class="function">ref</span>(props.selectedLeaveType);

<span class="comment">// When leave type selection changes, reload the page with new filter</span>
<span class="function">watch</span>(selectedType, (newValue) => {
    router.<span class="function">get</span>(
        <span class="function">route</span>(<span class="string">'manager.dashboard'</span>), 
        { leave_type: newValue }, 
        { preserveState: <span class="keyword">true</span> }
    );
});
</pre>

            <h3>When to Use Each</h3>
            <table>
                <thead>
                    <tr>
                        <th>Function</th>
                        <th>Use When</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code class="inline-code">ref()</code></td>
                        <td>You need a reactive variable</td>
                        <td>Form fields, toggles, counters</td>
                    </tr>
                    <tr>
                        <td><code class="inline-code">computed()</code></td>
                        <td>Value depends on other values</td>
                        <td>Filtered lists, formatted dates</td>
                    </tr>
                    <tr>
                        <td><code class="inline-code">watch()</code></td>
                        <td>Run side effects on change</td>
                        <td>API calls, localStorage, logging</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Functions -->
        <div class="card">
            <h2>4. Regular Functions</h2>
            <p>Not everything needs to be reactive. Regular functions work for event handlers and utilities.</p>

<pre>
<span class="comment">// Employee/Dashboard.vue</span>

<span class="comment">// Utility function - formats a date string</span>
<span class="keyword">function</span> <span class="function">formatDate</span>(dateString) {
    <span class="keyword">return new</span> <span class="function">Date</span>(dateString).<span class="function">toLocaleDateString</span>(<span class="string">'en-US'</span>, {
        month: <span class="string">'short'</span>,
        day: <span class="string">'numeric'</span>,
        year: <span class="string">'numeric'</span>
    });
}

<span class="comment">// Event handler - called when button is clicked</span>
<span class="keyword">function</span> <span class="function">cancelRequest</span>(id) {
    <span class="keyword">if</span> (<span class="function">confirm</span>(<span class="string">'Are you sure you want to cancel this request?'</span>)) {
        router.<span class="function">patch</span>(<span class="function">route</span>(<span class="string">'request.cancel'</span>, id));
    }
}

<span class="comment">// Form submit handler</span>
<span class="keyword">function</span> <span class="function">submit</span>() {
    form.<span class="function">post</span>(<span class="function">route</span>(<span class="string">'employee.store-request'</span>), {
        onSuccess: () => form.<span class="function">reset</span>(),
    });
}

<span class="comment">// Helper function - returns CSS classes based on balance</span>
<span class="keyword">function</span> <span class="function">getBalanceColor</span>(balance) {
    <span class="keyword">const</span> available = <span class="function">getAvailableBalance</span>(balance);
    <span class="keyword">const</span> percentage = (available / balance.balance) * 100;
    
    <span class="keyword">if</span> (available === 0) <span class="keyword">return</span> <span class="string">'bg-gray-100 text-gray-400'</span>;
    <span class="keyword">if</span> (percentage > 50) <span class="keyword">return</span> <span class="string">'bg-green-50 text-green-700'</span>;
    <span class="keyword">if</span> (percentage >= 10) <span class="keyword">return</span> <span class="string">'bg-yellow-50 text-yellow-700'</span>;
    <span class="keyword">return</span> <span class="string">'bg-red-50 text-red-700'</span>;
}
</pre>
        </div>

        <!-- Summary -->
        <div class="card">
            <h2>Quick Reference</h2>
            <table>
                <thead>
                    <tr>
                        <th>Concept</th>
                        <th>Syntax</th>
                        <th>Script Access</th>
                        <th>Template Access</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ref()</td>
                        <td><code class="inline-code">const x = ref(0)</code></td>
                        <td><code class="inline-code">x.value</code></td>
                        <td><code class="inline-code">{{ x }}</code></td>
                    </tr>
                    <tr>
                        <td>computed()</td>
                        <td><code class="inline-code">const x = computed(() => ...)</code></td>
                        <td><code class="inline-code">x.value</code></td>
                        <td><code class="inline-code">{{ x }}</code></td>
                    </tr>
                    <tr>
                        <td>props</td>
                        <td><code class="inline-code">const props = defineProps({...})</code></td>
                        <td><code class="inline-code">props.name</code></td>
                        <td><code class="inline-code">{{ name }}</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Navigation -->
        <div class="card">
            <h2>Continue Learning</h2>
            <div class="grid grid-2">
                <a href="templates.html" class="tech-card" style="text-decoration: none;">
                    <div class="icon">üè∑Ô∏è</div>
                    <h3>Templates</h3>
                    <p>v-if, v-for, v-model, events</p>
                </a>
                <a href="forms.html" class="tech-card" style="text-decoration: none;">
                    <div class="icon">üìã</div>
                    <h3>Forms</h3>
                    <p>useForm(), validation</p>
                </a>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>Vue.js Study Guide - Leave Request App</p>
    </footer>
</body>
</html>
