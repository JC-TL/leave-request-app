# Leave Request App - Cursor Prompt for UI Build

You are an expert Laravel + Blade developer. Your task is to build the UI for a leave request application. Study the user's existing codebase to match their exact coding style, naming conventions, and architectural patterns.

## CRITICAL - Start Here

**Before you generate any code:**
1. Analyze the user's entire Laravel project folder thoroughly
2. Study their existing views, controllers, routes, and styling approach
3. Understand their:
   - Blade template structure and organization
   - CSS/Tailwind usage patterns
   - Form handling conventions
   - Error handling approach
   - Naming conventions for variables, methods, functions
   - How they structure components and partials
   - Navigation/layout patterns
4. Match their exact style on every new file generated
5. Ask clarifying questions if any patterns are unclear

---

## Project Context

**Application:** Leave Request Management System
**Framework:** Laravel 11 with Blade Templates
**Database:** SQLite
**Models:** User, Department, Balance, Policy, Request
**Roles:** employee, dept_manager, hr_admin, ceo

---

## Existing Models & Relationships

### User Model
- Relationships: department, manager, leaveRequests, leaveBalances
- Methods: isEmployee(), isDeptManager(), isHRAdmin(), getLeaveBalance()

### Request Model (leave_requests table)
- Relationships: employee, departmentManager, hrApprover
- Methods: isPending(), isDeptManagerApproved(), isApproved(), isRejected(), getStatusLabel()
- Scopes: pending(), approved(), rejected(), byEmployee(), betweenDates()

### Balance Model (leave_balances table)
- Relationships: user
- Methods: getAvailableBalance(), deductDays(), addDays(), hasSufficientBalance()

### Department Model
- Relationships: manager, employees

### Policy Model (leave_policies table)
- Leave types: Vacation Leave, Sick Leave, Emergency Leave, Maternity Leave, Paternity Leave, Bereavement Leave, Special Leave, Unpaid Leave

---

## 4 UIs to Build

### UI 1: Home Page (Login)

**Route:** `GET /` and `POST /login`
**Auth Required:** No
**Features:**
- Simple login form (email & password)
- Logo/branding area
- Error messages display
- Remember me checkbox (optional)
- Password reset link (optional for MVP)
- Responsive design

**Form Fields:**
- Email input
- Password input
- Login button
- Remember me checkbox

**After successful login:** Redirect to appropriate dashboard based on role

---

### UI 2: Employee Dashboard

**Route:** `GET /employee/dashboard`
**Auth Required:** Yes (only employees)
**Features:**

**Section 1: Leave Balance Display**
- Show all 8 leave types
- Display: Balance / Total Available
- Color coding: 
  - Green if balance > 50% of total
  - Yellow if balance 10-50% of total
  - Red if balance < 10% of total
  - Grey if balance = 0 (disabled)
- Show balance as cards or table

**Section 2: Submit Leave Request Form**
- Only enabled if user has balance > 0 in at least one leave type
- Form fields:
  - Leave Type dropdown (only show types with balance > 0)
  - Start Date input
  - End Date input
  - Reason textarea
  - Number of days (auto-calculate based on start/end date, excluding weekends)
  - Submit button
- Validation:
  - Show error if insufficient balance
  - Show error if dates are invalid
  - Show success message on submission

**Section 3: My Leave Requests History**
- Table showing all their leave requests
- Columns: Leave Type, Start Date, End Date, Days, Status, Actions
- Status badges with colors:
  - Yellow: Pending
  - Blue: Manager Approved
  - Green: Approved
  - Red: Rejected
- Action buttons: View Details, Cancel (if pending)
- Sort by newest first
- Pagination if many requests

**Section 4: Navigation**
- Logout button
- User name/email display
- Role badge

---

### UI 3: Department Manager Dashboard

**Route:** `GET /manager/dashboard`
**Auth Required:** Yes (only dept_managers)
**Features:**

**Section 1: Summary Stats**
- Pending approvals count
- Approved this month count
- Team members count

**Section 2: Pending Requests from My Team**
- Table showing all pending requests from employees under this manager
- Columns: Employee Name, Leave Type, Start Date, End Date, Days, Submitted Date, Actions
- Status badge: "Pending Your Approval"
- Action buttons: Approve, Reject, View Details
- Sort by submitted date (newest first)
- Pagination if many requests

**Section 3: Team Members List**
- Table showing all employees in their department
- Columns: Name, Email, Current Vacation Leave Balance, Total Available
- Action buttons: View Leave History
- Shows which employees have low balance (< 3 days)

**Section 4: Request Details Modal/Page**
When clicking "View Details" or "Approve/Reject":
- Employee details: Name, Department, Email
- Request details: Leave Type, Start Date, End Date, Days, Reason, Submitted Date
- Current balance of employee
- Approve button with optional comment field
- Reject button with required reason field
- Back button to return to list

**Section 5: Navigation**
- Logout button
- Dashboard link
- User name/role display

---

### UI 4: HR Admin Dashboard

**Route:** `GET /hr/dashboard`
**Auth Required:** Yes (only hr_admin)
**Features:**

**Section 1: Summary Stats Cards**
- Total pending requests (waiting for HR approval)
- Total approved this month
- Total rejected this month
- Total employees
- Employees on leave today (optional)

**Section 2: Pending Requests Awaiting HR Approval**
- Table showing all requests with status 'dept_manager_approved' or 'pending'
- Columns: Employee Name, Department, Leave Type, Start Date, End Date, Days, Manager Approval Status, Submitted Date, Actions
- Status badges:
  - Orange: "Pending Manager" (if still pending manager approval)
  - Blue: "Manager Approved - Waiting HR"
- Action buttons: Approve, Reject, View Details
- Filter options: By department, by leave type, by status
- Sort by submitted date (newest first)
- Pagination

**Section 3: Request Details View**
When clicking "View Details" or "Approve/Reject":
- Employee details: Name, Department, Email, Phone (if available)
- Employee's leave balance for this leave type: Current Balance / Total Available
- Request details: Leave Type, Start Date, End Date, Days, Reason, Submitted Date
- Approval timeline:
  - Manager approval: Status, Approver Name, Date, Comment (if exists)
  - HR approval: (To be filled)
- Approve button with optional comment field
- Reject button with required reason field
- Back button

**Section 4: Leave Balance Lookup (Optional but Useful)**
- Search employee by name
- Show all their leave balances
- Show their recent requests
- Help HR manage leave

**Section 5: Approved Requests**
- Tab or separate view showing all approved requests this month
- Table: Employee, Department, Leave Type, Dates, Approver
- Can filter by date range

**Section 6: Leave Policies**
- Table showing all leave policies
- Columns: Leave Type, Annual Entitlement, Code
- Edit button for each policy
- Update modal with validation

**Section 7: Navigation**
- Logout button
- Dashboard link
- Policies link
- User name/role display

---

## Technical Requirements

### Controllers to Create

**AuthController:**
- showLoginForm() → login view
- login() → validate & authenticate
- logout() → logout user

**EmployeeController:**
- dashboard() → employee dashboard view
- storeRequest() → submit leave request
- cancelRequest() → cancel pending request

**ManagerController:**
- dashboard() → manager dashboard view
- showRequest() → show request details
- approveRequest() → approve request
- rejectRequest() → reject request

**HRController:**
- dashboard() → HR dashboard view
- showRequest() → show request details
- approveRequest() → approve request
- rejectRequest() → reject request
- editPolicy() → edit leave policy
- updatePolicy() → update policy

### Routes to Create

```php
// Public routes
Route::get('/', [AuthController::class, 'showLoginForm'])->name('login');
Route::post('/login', [AuthController::class, 'login']);

// Protected routes
Route::middleware('auth')->group(function () {
    Route::post('/logout', [AuthController::class, 'logout'])->name('logout');
    
    // Employee routes
    Route::middleware('role:employee')->group(function () {
        Route::get('/employee/dashboard', [EmployeeController::class, 'dashboard'])->name('employee.dashboard');
        Route::post('/employee/request', [EmployeeController::class, 'storeRequest'])->name('employee.store-request');
        Route::patch('/request/{id}/cancel', [EmployeeController::class, 'cancelRequest'])->name('request.cancel');
    });
    
    // Manager routes
    Route::middleware('role:dept_manager')->group(function () {
        Route::get('/manager/dashboard', [ManagerController::class, 'dashboard'])->name('manager.dashboard');
        Route::get('/manager/request/{id}', [ManagerController::class, 'showRequest'])->name('manager.show-request');
        Route::patch('/manager/request/{id}/approve', [ManagerController::class, 'approveRequest'])->name('manager.approve-request');
        Route::patch('/manager/request/{id}/reject', [ManagerController::class, 'rejectRequest'])->name('manager.reject-request');
    });
    
    // HR Admin routes
    Route::middleware('role:hr_admin')->group(function () {
        Route::get('/hr/dashboard', [HRController::class, 'dashboard'])->name('hr.dashboard');
        Route::get('/hr/request/{id}', [HRController::class, 'showRequest'])->name('hr.show-request');
        Route::patch('/hr/request/{id}/approve', [HRController::class, 'approveRequest'])->name('hr.approve-request');
        Route::patch('/hr/request/{id}/reject', [HRController::class, 'rejectRequest'])->name('hr.reject-request');
        Route::get('/hr/policies', [HRController::class, 'policies'])->name('hr.policies');
        Route::patch('/hr/policy/{id}', [HRController::class, 'updatePolicy'])->name('hr.update-policy');
    });
});
```

### Key Services/Methods to Use

From your models:
- `Auth::user()` - Get current logged-in user
- `$user->isEmployee()`, `$user->isDeptManager()`, `$user->isHRAdmin()`
- `$user->department` - Get user's department
- `$user->leaveRequests` - Get user's requests
- `$user->leaveBalances` - Get user's balances
- `$user->getLeaveBalance($type, $year)` - Get specific balance
- `Request::pending()` - Query pending requests
- `Request::approved()` - Query approved requests
- `$request->getStatusLabel()` - Get human-readable status
- `$balance->hasSufficientBalance($days)` - Check if enough balance

---

## Blade Template Structure

Create these files in `resources/views/`:

```
resources/views/
├── layouts/
│   ├── app.blade.php (main layout)
│   └── auth.blade.php (login layout)
├── auth/
│   └── login.blade.php
├── employee/
│   └── dashboard.blade.php
├── manager/
│   └── dashboard.blade.php
├── hr/
│   └── dashboard.blade.php
└── components/ (if using Blade components)
    ├── balance-card.blade.php
    ├── request-table.blade.php
    ├── status-badge.blade.php
    └── etc.
```

---

## Styling

- Use Tailwind CSS (already configured in Laravel)
- Keep consistent with user's existing Tailwind usage
- Color scheme:
  - Green: Success/Approved (#10b981)
  - Yellow: Pending (#f59e0b)
  - Red: Rejected/Danger (#ef4444)
  - Blue: Info (#3b82f6)
  - Grey: Disabled (#9ca3af)
- Responsive design (mobile-first)
- Dark mode optional

---

## Form Handling

- Use Laravel's `@csrf` token
- Display validation errors with user's existing pattern
- Success/error flash messages
- Use `old()` helper for repopulating forms on error

---

## Additional Features to Consider

For each dashboard:
- Export to PDF/CSV (optional, nice to have)
- Search/filter functionality
- Date range filters
- Print functionality
- Responsive tables on mobile
- Loading states for buttons
- Confirmation modals for sensitive actions

---

## Generate Code For

Ask me to generate code for each section in this order:

1. **Middleware & Auth Controller** - Login, logout, role checking
2. **Login View** - Home page
3. **Employee Controller & Dashboard View** - Leave submission form, balance display, request history
4. **Manager Controller & Dashboard View** - Team requests, approval interface, team members list
5. **HR Controller & Dashboard View** - All requests, approval interface, policies management
6. **Reusable Components** - Status badges, balance cards, tables, modals
7. **Routes** - All routes configuration
8. **Services** (if needed) - Business logic for approvals, calculations, notifications

---

## Remember

- Study the user's code style FIRST
- Match their exact patterns and conventions
- Use their naming conventions throughout
- Keep code DRY (don't repeat yourself)
- Add comments only for complex logic
- Make forms user-friendly with helpful error messages
- Ensure proper authorization (users can only see their own data)
- Test URLs are intuitive and RESTful

---

## Special Notes

- When displaying leave requests, always show employee's current balance for that leave type
- When approving, check sufficient balance exists
- When rejecting, show the rejection reason to employee
- Disable form inputs if balance is 0
- Show warning if only 1-3 days remaining
- Allow cancellation only for pending requests
- Show manager approval status to HR before they approve
- CEO auto-approves (no approval page needed, just auto-approved in controller)